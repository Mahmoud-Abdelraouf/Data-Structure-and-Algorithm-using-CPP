% Define the array of sizes
arraySizes = [1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000, ...
    11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, ...
    20000, 21000, 22000, 23000, 24000, 25000, 26000, 27000, 28000, ...
    29000, 30000, 31000, 32000, 33000, 34000, 35000, 36000, 37000, ...
    38000, 39000, 40000, 41000, 42000, 43000, 44000, 45000, 46000, ...
    47000, 48000, 49000, 50000, 51000, 52000, 53000, 54000, 55000, ...
    56000, 57000, 58000, 59000, 60000, 61000, 62000, 63000, 64000, ...
    65000, 66000, 67000, 68000, 69000, 70000, 71000, 72000, 73000, ...
    74000, 75000, 76000, 77000, 78000, 79000, 80000, 81000, 82000, ...
    83000, 84000, 85000, 86000, 87000, 88000, 89000, 90000, 91000, ...
    92000, 93000, 94000, 95000, 96000, 97000, 98000, 99000, 100000];

% Define the corresponding execution times
executionTimes = [14, 42, 40, 55, 69, 80, 94, 127, 125, 139, 160, 172, ...
    193, 207, 224, 248, 229, 253, 264, 275, 286, 287, 317, 326, 328, ...
    395, 364, 381, 390, 408, 421, 510, 446, 518, 490, 495, 504, 702, ...
    583, 542, 551, 704, 575, 585, 610, 606, 642, 657, 660, 678, 741, ...
    706, 697, 748, 751, 769, 814, 807, 805, 793, 812, 823, 848, 835, ...
    851, 868, 896, 891, 912, 909, 927, 953, 992, 952, 994, 989, 1006, ...
    1035, 1130, 1063, 1026, 1029, 1049, 1135, 1109, 1091, 1104, 1131, ...
    1139, 1162, 1177, 1177, 1201, 1223, 1235, 1269, 1265, 1273, 1703, ...
    1294];

% Define the size of the smoothing window
windowSize = 5;

% Create a moving average filter
b = (1/windowSize)*ones(1,windowSize);
a = 1;

% Apply the filter to smooth the execution times
smoothedExecutionTimes = filter(b, a, executionTimes);

% Perform linear regression to find the best fit line
p = polyfit(arraySizes, smoothedExecutionTimes, 1);

% Plot the original data, smoothed data, and best fit line
figure;
plot(arraySizes, executionTimes, 'o-', 'LineWidth', 1.5, 'DisplayName', 'Original Data');
hold on;
plot(arraySizes, smoothedExecutionTimes, 'r-', 'LineWidth', 2, 'DisplayName', 'Smoothed Data');
plot(arraySizes, polyval(p, arraySizes), 'g-', 'LineWidth', 2, 'DisplayName', 'Best Fit Line');
xlabel('Array Size');
ylabel('Execution Time (microseconds)');
title('Execution Time vs Array Size');
grid on;
legend('Location', 'Best');

% Display the equation of the best fit line on the plot
equation = sprintf('y = %.4fx + %.4f', p(1), p(2));
text(0.6, 0.8, equation, 'Units', 'Normalized', 'FontSize', 12, 'BackgroundColor', [1 1 1], 'EdgeColor', [0 0 0]);
